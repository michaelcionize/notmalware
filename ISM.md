```PowerShell
#region Variables
    #region ISM-0341
    $ISM_0341 = @{
                    Name='ISM-0341';
                    Description='Automatic execution features for removable media are disabled.';
                    Implementation_Status='Not Assessed';
                    Compliance_Status='';
                    Admin_Corporate_environment='Applicable to administrator devices that store or process customer data.';
                    Revision='1';
                    Updated='Sep-21';
                    Guideline='Guidelines for System Hardening';
                    Section='Operating system hardening';
                    Topic='Hardening operating system configurations';
                    Result=''
                }
    New-Object PSObject –Property $ISM_0341
    #endregion
    #region ISM-1621
    $ISM_1621 = @{
                    Name='ISM-1621';
                    Description='Windows PowerShell 2.0 is disabled or removed.';
                    Implementation_Status='Not Assessed';
                    Compliance_Status='';
                    Admin_Corporate_environment='Applicable to devices used to administer cloud infrastructure.';
                    Revision='1';
                    Updated='Sep-21';
                    Guideline='Guidelines for System Hardening';
                    Section='Operating system hardening';
                    Topic='PowerShell';
                    Result=''
                }
    New-Object PSObject –Property $ISM_1621
    #endregion
    #region ISM-1622
    $ISM_1622 = @{
                    Name='ISM-1622';
                    Description='PowerShell is configured to use Constrained Language Mode.';
                    Implementation_Status='Not Assessed';
                    Compliance_Status='';
                    Admin_Corporate_environment='Applicable to devices used to administer cloud infrastructure.';
                    Revision='0';
                    Updated='Oct-20';
                    Guideline='Guidelines for System Hardening';
                    Section='Operating system hardening';
                    Topic='PowerShell';
                    Result=''
                }
    New-Object PSObject –Property $ISM_1622
    #endregion
    #region ISM-1623
    $ISM_1623 = @{
                    Name='ISM-1623';
                    Description='PowerShell is configured to use module logging, script block logging and transcription functionality.';
                    Implementation_Status_module_logging='Not Assessed';
                    Implementation_Status_script_block_logging='Not Assessed';
                    Implementation_Status_transcription_functionality='Not Assessed';
                    Compliance_Status='';
                    Admin_Corporate_environment='Applicable to devices used to administer cloud infrastructure.';
                    Revision='0';
                    Updated='Oct-20';
                    Guideline='Guidelines for System Hardening';
                    Section='Operating system hardening';
                    Topic='PowerShell';
                    Result_module_logging='';
                    Result_script_block_logging='';
                    Result_transcription_functionality=''
                }
    New-Object PSObject –Property $ISM_1623
    #endregion
    #region ISM-1654
    $ISM_1654 = @{
                    Name='ISM-1654';
                    Description='Internet Explorer 11 is disabled or removed.';
                    Implementation_Status='Not Assessed';
                    Compliance_Status='';
                    Admin_Corporate_environment='Applicable to devices used to administer cloud infrastructure.';
                    Revision='0';
                    Updated='Sep-21';
                    Guideline='Guidelines for System Hardening';
                    Section='Operating system hardening';
                    Topic='Hardening operating system configurations';
                    Result=''
                }
    New-Object PSObject –Property $ISM_1654
    #endregion
    #region ISM-1655
    $ISM_1655 = @{
                    Name='ISM-1655';
                    Description='.NET Framework 3.5 (includes .NET 2.0 and 3.0) is disabled or removed.';
                    Implementation_Status_2_0='Not Assessed';
                    Implementation_Status_3_0='Not Assessed';
                    Implementation_Status_3_5='Not Assessed';
                    Compliance_Status='';
                    Admin_Corporate_environment='Applicable to devices used to administer cloud infrastructure.';
                    Revision='0';
                    Updated='Sep-21';
                    Guideline='Guidelines for System Hardening';
                    Section='Operating system hardening';
                    Topic='Hardening operating system configurations';
                    Result_2_0='';
                    Result_3_0='';
                    Result_3_5=''
                }
    New-Object PSObject –Property $ISM_1655
    #endregion
#endregion

$ErrorActionPreference = 'SilentlyContinue'
#region Tests
    #region ISM-0341
    $ISM_0341.Result = (Get-ItemProperty HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer).NoDriveTypeAutoRun
    if ($ISM_0341.Result -eq '255') {
        $ISM_0341.Implementation_Status = 'Assessed'
        $ISM_0341.Compliance_Status = 'Compliant'
        Write-Host ($ISM_0341.Name) '-' ($ISM_0341.Description) '-' 'Result: Automatic Execution for removeable media is disabled' -ForegroundColor Green
        }
    elseif(-not($ISM_0341.Result -eq '255')) {
        $ISM_0341.Implementation_Status = 'Assessed'
        $ISM_0341.Compliance_Status = 'Non Compliant'
        Write-Host ($ISM_0341.Name) '-' ($ISM_0341.Description) '-' 'Result: Automatic Execution for removeable media is not disabled' -ForegroundColor Red
        }
    #endregion
    #region ISM-1621
    $ISM_1621.Result = (Get-ItemProperty 'HKLM:\SOFTWARE\Microsoft\PowerShell\1\PowerShellEngine').PowerShellVersion
    if (-Not($ISM_1621.Result -eq '2.0')) {
        $ISM_1621.Implementation_Status = 'Assessed'
        $ISM_1621.Compliance_Status = 'Compliant'
        Write-Host ($ISM_1621.Name) '-' ($ISM_1621.Description) '-' 'Result: PowerShell version 2.0 was not found' -ForegroundColor Green
        }
    elseif($ISM_1621.Result -eq '2.0') {
        $ISM_1621.Implementation_Status = 'Assessed'
        $ISM_1621.Compliance_Status = 'Non Compliant'
        Write-Host ($ISM_1621.Name) '-' ($ISM_1621.Description) '-' 'Result: PowerShell version 2.0 was found' -ForegroundColor Red
        }
    #endregion
    #region ISM-1622
    $ISM_1622.Result = $ExecutionContext.SessionState.LanguageMode
    if ($ISM_1622.Result -eq 'ConstrainedLanguage') {
        $ISM_1622.Implementation_Status = 'Assessed'
        $ISM_1622.Compliance_Status = 'Compliant'
        Write-Host ($ISM_1622.Name) '-' ($ISM_1622.Description) '-' 'Result: PowerShell Constrained Language mode is enabled' -ForegroundColor Green
        }
    elseif($ISM_1622.Result -eq 'FullLanguage') {
        $ISM_1622.Implementation_Status = 'Assessed'
        $ISM_1622.Compliance_Status = 'Non Compliant'
        Write-Host ($ISM_1622.Name) '-' ($ISM_1622.Description) '-' 'Result: PowerShell Full Language mode is enabled' -ForegroundColor Red
        }
    #endregion
    #region ISM-1623
    $ISM_1623.Result_module_logging = (Get-ItemProperty 'HKLM:\SOFTWARE\WOW6432Node\Policies\Microsoft\Windows\PowerShell\ModuleLogging').EnableModuleLogging
    if ($ISM_1623.Result_module_logging -eq 1) {
        $ISM_1623.Implementation_Status_module_logging = 'Assessed'
        $ISM_1623.Result_module_logging = 'Compliant'
        Write-Host ($ISM_1623.Name) '-' ($ISM_1623.Description) '-' 'Result: PowerShell module logging is enabled' -ForegroundColor Green
        }
    elseif($ISM_1623.Result_module_logging -ne 1) {
        $ISM_1623.Implementation_Status_module_logging = 'Assessed'
        $ISM_1623.Result_module_logging = 'Non Compliant'
        Write-Host ($ISM_1623.Name) '-' ($ISM_1623.Description) '-' 'Result: PowerShell module logging is disabled' -ForegroundColor Red
        }
    $ISM_1623.Result_script_block_logging = (Get-ItemProperty 'HKLM:\SOFTWARE\WOW6432Node\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging').EnableScriptBlockLogging
    if ($ISM_1623.Result_script_block_logging -eq 1) {
        $ISM_1623.Implementation_Status_script_block_logging = 'Assessed'
        $ISM_1623.Result_script_block_logging = 'Compliant'
        Write-Host ($ISM_1623.Name) '-' ($ISM_1623.Description) '-' 'Result: PowerShell script block logging is enabled' -ForegroundColor Green
        }
    elseif($ISM_1623.Result_script_block_logging -ne 1) {
        $ISM_1623.Implementation_Status_script_block_logging = 'Assessed'
        $ISM_1623.Result_script_block_logging = 'Non Compliant'
        Write-Host ($ISM_1623.Name) '-' ($ISM_1623.Description) '-' 'Result: PowerShell script block logging is disabled' -ForegroundColor Red
        }
    $ISM_1623.Result_transcription_functionality = (Get-ItemProperty 'HKLM:\SOFTWARE\WOW6432Node\Policies\Microsoft\Windows\PowerShell\Transcription').EnableTranscripting
    if ($ISM_1623.Result_transcription_functionality -eq 1) {
        $ISM_1623.Implementation_Status_transcription_functionality = 'Assessed'
        $ISM_1623.Result_transcription_functionality = 'Compliant'
        Write-Host ($ISM_1623.Name) '-' ($ISM_1623.Description) '-' 'Result: PowerShell transcription functionality is enabled' -ForegroundColor Green
        }
    elseif($ISM_1623.Result_transcription_functionality -ne 1) {
        $ISM_1623.Implementation_Status_transcription_functionality = 'Assessed'
        $ISM_1623.Result_transcription_functionality = 'Non Compliant'
        Write-Host ($ISM_1623.Name) '-' ($ISM_1623.Description) '-' 'Result: PowerShell transcription functionality is disabled' -ForegroundColor Red
        }
    if ($ISM_1623.Result_module_logging -eq 'Non Compliant' -or $ISM_1623.Result_script_block_logging -eq 'Non Compliant' -or $ISM_1623.Result_transcription_functionality -eq 'Non Compliant') {
        $ISM_1623.Compliance_Status = 'Non Compliant'
    }
    elseif ($ISM_1623.Result_module_logging -eq 'Compliant' -and $ISM_1623.Result_script_block_logging -eq 'Compliant' -and $ISM_1623.Result_transcription_functionality -eq 'Compliant') {
        $ISM_1623.Compliance_Status = 'Compliant'
    }
    #endregion
    #region ISM-1654
    $ISM_1654.Result = (Get-ItemProperty 'HKLM:\SOFTWARE\Microsoft\Internet Explorer').svcVersion
    if($ISM_1654.Result -eq $null){
        $ISM_1654.Implementation_Status = 'Assessed'
        $ISM_1654.Compliance_Status = 'Compliant'
        Write-Host ($ISM_1654.Name) '-' ($ISM_1654.Description) '-' 'Result: Internet Explorer 11 is not found' -ForegroundColor Green
        }
    elseif($ISM_1654.Result) {
        $ISM_1654.Implementation_Status = 'Assessed'
        $ISM_1654.Compliance_Status = 'Non Compliant'
        Write-Host ($ISM_1654.Name) '-' ($ISM_1654.Description) '-' 'Result: Internet Explorer 11 is installed' -ForegroundColor Red
        }
    #endregion
    #region ISM-1655
    $ISM_1655.Result_2_0 = (Get-ChildItem 'HKLM:\SOFTWARE\Microsoft\NET Framework Setup\NDP' -Recurse | Get-ItemProperty -Name version -EA 0 | Where { $_.PSChildName -Match '^(?!S)\p{L}'} | Select -ExpandProperty version | Where-Object {$_ -like '2.0*'})
    if (-Not($ISM_1655.Result_2_0)) {
        $ISM_1655.Implementation_Status_2_0 = 'Assessed'
        $ISM_1655.Result_2_0 = 'Compliant'
        Write-Host ($ISM_1655.Name) '-' ($ISM_1655.Description) '-' 'Result: .NET Framework version 2.0 was not found' -ForegroundColor Green
        }
    elseif($ISM_1655.Result_2_0) {
        $ISM_1655.Implementation_Status_2_0 = 'Assessed'
        $ISM_1655.Result_2_0 = 'Non Compliant'
        Write-Host ($ISM_1655.Name) '-' ($ISM_1655.Description) '-' 'Result: .NET Framework version 2.0 was found' -ForegroundColor Red
        }
    $ISM_1655.Result_3_0 = (Get-ChildItem 'HKLM:\SOFTWARE\Microsoft\NET Framework Setup\NDP' -Recurse | Get-ItemProperty -Name version -EA 0 | Where { $_.PSChildName -Match '^(?!S)\p{L}'} | Select -ExpandProperty version | Where-Object {$_ -like '3.0*'})
    if (-Not($ISM_1655.Result_3_0)) {
        $ISM_1655.Implementation_Status_3_0 = 'Assessed'
        $ISM_1655.Result_3_0 = 'Compliant'
        Write-Host ($ISM_1655.Name) '-' ($ISM_1655.Description) '-' 'Result: .NET Framework version 3.0 was not found' -ForegroundColor Green
        }
    elseif($ISM_1655.Result_3_0) {
        $ISM_1655.Implementation_Status_3_0 = 'Assessed'
        $ISM_1655.Result_3_0 = 'Non Compliant'
        Write-Host ($ISM_1655.Name) '-' ($ISM_1655.Description) '-' 'Result: .NET Framework version 3.0 was found' -ForegroundColor Red
        }
    $ISM_1655.Result_3_5 = (Get-ChildItem 'HKLM:\SOFTWARE\Microsoft\NET Framework Setup\NDP' -Recurse | Get-ItemProperty -Name version -EA 0 | Where { $_.PSChildName -Match '^(?!S)\p{L}'} | Select -ExpandProperty version | Where-Object {$_ -like '3.5*'})
    if (-Not($ISM_1655.Result_3_5)) {
        $ISM_1655.Implementation_Status_3_5 = 'Assessed'
        $ISM_1655.Result_3_5 = 'Compliant'
        Write-Host ($ISM_1655.Name) '-' ($ISM_1655.Description) '-' 'Result: .NET Framework version 3.5 was not found' -ForegroundColor Green
        }
    elseif($ISM_1655.Result_3_5) {
        $ISM_1655.Implementation_Status_3_5 = 'Assessed'
        $ISM_1655.Result_3_5 = 'Non Compliant'
        Write-Host ($ISM_1655.Name) '-' ($ISM_1655.Description) '-' 'Result: .NET Framework version 3.5 was found' -ForegroundColor Red
        }
    if ($ISM_1655.Result_2_0 -eq 'Non Compliant' -or $ISM_1655.Result_3_0 -eq 'Non Compliant' -or $ISM_1655.Result_3_5 -eq 'Non Compliant') {
        $ISM_1655.Compliance_Status = 'Non Compliant'
    }
    elseif ($ISM_1655.Result_2_0 -eq 'Compliant' -and $ISM_1655.Result_3_0 -eq 'Compliant' -and $ISM_1655.Result_3_5 -eq 'Compliant') {
        $ISM_1655.Compliance_Status = 'Compliant'
    }
    #endregion
#endregion

#\SOFTWARE\Microsoft\Office\16.0\Excel\


#(Get-ChildItem HKCU:\SOFTWARE\Microsoft\Office\16.0\Excel\Security)
#HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\14.0\msproject\security\VBAWarnings


# Get all Hives under Office that contain a security sub folder. 



#$Paths = Get-ChildItem HKCU:\SOFTWARE\Microsoft\Office\ -Recurse | 
#Where-Object {$_.Name -like '*Security' -and $_.Name -notlike '*Common*'} | 
#Select -ExpandProperty Name | ForEach-Object {$_ -replace 'HKEY_CURRENT_USER','HKCU:'}




#Foreach ($Path in $Paths) {
   #If ((Get-ItemProperty $Path).VBAWarnings) {Write-Host "$Path VBAWarnings Exists"}
#}

#Get-ItemProperty HKCU:\SOFTWARE\Microsoft\Office\16.0\Word\Security
```
